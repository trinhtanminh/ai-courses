<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Courses - Ứng dụng</title>
    <link rel="dns-prefetch" href="//cdn.tailwindcss.com" />
    <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin />
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://firestore.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://identitytoolkit.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://securetoken.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://firebasestorage.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://firebasestorage.app" crossorigin />
    <link rel="modulepreload" href="/js/firebase.js" />
    <link rel="modulepreload" href="/js/auth.js" />
    <link rel="modulepreload" href="/js/components.user.js" />
    <link rel="modulepreload" href="/js/courses.js" />
    <link rel="modulepreload" href="/js/user.app.js" />
    <link rel="modulepreload" href="/js/header.js" />
    <link rel="preload" as="style" href="/css/liquid.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/css/liquid.css" />
  </head>
  <body class="apple text-gray-900 min-h-screen flex flex-col">
    <div id="siteHeader"></div>

    <main class="container w-full max-w-none px-4 py-6 flex-1">
      <div class="w-full grid grid-cols-1 md:grid-cols-[260px,1fr] gap-6 min-h-full">
        <aside class="glass-sidebar h-max">
          <div class="nav-header">
            <div class="nav-title">Điều hướng</div>
            <div class="nav-badge">User</div>
          </div>

          <div class="nav-section">Tài khoản</div>
          <nav class="nav-list">
            <a class="nav-pill" href="#dashboard">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="9" rx="2"/><rect x="14" y="3" width="7" height="5" rx="2"/><rect x="14" y="10" width="7" height="11" rx="2"/><rect x="3" y="14" width="7" height="7" rx="2"/></svg>
              <span>Bảng điều khiển</span>
            </a>
            <a id="sbAdminLink" class="nav-pill hidden" href="/admin.html">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              <span>Quản trị</span>
            </a>
            <a id="sbLoginLink" class="nav-pill" href="/login.html">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
              <span>Đăng nhập</span>
            </a>
          </nav>

          <div class="nav-section">Khám phá</div>
          <nav class="nav-list">
            <a class="nav-pill active" href="#home">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7"/><path d="M9 22V12h6v10"/></svg>
              <span>Trang chủ</span>
            </a>
            <a class="nav-pill" href="#courses">
              <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5V6.5a2 2 0 0 1 1.2-1.84l5.6-2.5a2 2 0 0 1 1.6 0l5.6 2.5A2 2 0 0 1 19 6.5v13"/><path d="M4 6.5l8 3.5 8-3.5"/><path d="M12 10v12"/></svg>
              <span>Tất cả khoá học</span>
            </a>
          </nav>
        </aside>

        <section id="view" class="min-h-full w-full">
          <h1 class="text-2xl font-semibold mb-6">Danh sách khoá học</h1>
          <div id="courses" class="space-y-4">
            <div id="coursesList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
          </div>
        </section>
      </div>
    </main>

    <script type="module">
      import { auth } from './js/firebase.js';
      import { currentUserProfile, showAdminLinkIfAdmin } from './js/auth.js';
      import { setupUserApp } from './js/user.app.js';
      import { onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
      // Sidebar elements
      const sbLoginLink = document.getElementById('sbLoginLink');
      const sbAdminLink = document.getElementById('sbAdminLink');

      onAuthStateChanged(auth, async () => {
        const profile = await currentUserProfile();
        if (profile) {
          // Sidebar state
          sbLoginLink.classList.add('hidden');
          showAdminLinkIfAdmin(sbAdminLink, profile);
        } else {
          // Sidebar state
          sbLoginLink.classList.remove('hidden');
          sbAdminLink.classList.add('hidden');
        }
      });

      // Init user app (router + views)
      setupUserApp();
    </script>
    <script type="module" src="/js/header.js"></script>
  </body>
  </html>
